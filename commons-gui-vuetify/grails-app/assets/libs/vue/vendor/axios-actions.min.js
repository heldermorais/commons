!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.AxiosActions={})}(this,function(t){"use strict";function e(t){return"object"==typeof t&&!!t&&!Array.isArray(t)}function r(t){return void 0!==t&&null!==t}function n(t,r){for(var n=r.split(".");t&&n.length;){var o=n.shift();t=e(t)?t[o]:void 0}return t}function o(t){return Object.keys(t).reduce(function(e,r){return e[t[r]]=r,e},{})}function i(t,r,n){return r instanceof Function?r(t,n,i):e(r)?(n&&(r=o(r)),Object.keys(t).reduce(function(e,n){return e[r[n]||n]=t[n],e},{})):t}"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var u,a=(function(t,e){t.exports=function(){var t=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var r=Object.prototype.toString.call(t);return"[object RegExp]"===r||"[object Date]"===r||function(t){return t.$$typeof===e}(t)}(t)},e="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(t,e){return!1!==e.clone&&e.isMergeableObject(t)?o((r=t,Array.isArray(r)?[]:{}),t,e):t;var r}function n(t,e,n){return t.concat(e).map(function(t){return r(t,n)})}function o(e,i,u){(u=u||{}).arrayMerge=u.arrayMerge||n,u.isMergeableObject=u.isMergeableObject||t;var a=Array.isArray(i),c=Array.isArray(e),s=a===c;return s?a?u.arrayMerge(e,i,u):function(t,e,n){var i={};return n.isMergeableObject(t)&&Object.keys(t).forEach(function(e){i[e]=r(t[e],n)}),Object.keys(e).forEach(function(u){n.isMergeableObject(e[u])&&t[u]?i[u]=o(t[u],e[u],n):i[u]=r(e[u],n)}),i}(e,i,u):r(i,u)}return o.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(t,r){return o(t,r,e)},{})},o}()}(u={exports:{}},u.exports),u.exports);function c(t,r){if(void 0===r&&(r="get"),"string"==typeof t){var n=t.trim().match(/^(?:(get|post|patch|put|delete|head)\s+)?(\S+)$/i);if(n){var o=n[1],i=n[2];return{method:r=o?o.toLowerCase():r,url:i}}}else if(e(t)&&t.url)return t.method||(t.method=r),Object.assign({},t);throw new Error("Invalid request parameters")}function s(t,e){return void 0===e&&(e={}),a(t,e)}function f(t,o,i){if(void 0===i&&(i=/[:{](\w+[.\w]+)}?/),Array.isArray(o)){for(var u=[].concat(o);u.length;)t=t.replace(i,String(u.shift()));return t}var a=new RegExp(i.source,"g");return t.replace(a,function(t,i){var u=e(o)?n(o,i):o;return r(u)?u:""})}var p=Object.freeze({isObject:e,isValue:r,getValue:n,flipKeys:o,reKey:i,makeRequest:c,mergeOptions:s,replaceTokens:f}),h=function(t){this.axios=t,this.before=[],this.after=[],this.done=new Set,this.fail=new Set,this.queue=new Map,Object.freeze(this)};h.prototype.request=function(t,r,n){var o=this;void 0===n&&(n=null),t.error=null,t.loading=!0;var i=r.method,u=r.url;if(i=i.toLowerCase(),"function"!=typeof this.axios[i])throw new Error("No such HTTP method '"+i+"'");u=f(u,n=this.before.reduce(function(t,e){return e(t)},n)),(r=Object.assign({},r)).method=i,r.url=u,n&&("get"===i&&e(n)&&!u.includes("?")?r.params=n:r.data=n);var a=this.axios.request(r),c=Symbol(i+" "+u);this.queue.set(c,a);var s=function(e){o.queue.delete(e),t.loading=o.queue.size>0};return a.then(function(t){return s(c),o.after.forEach(function(e){var r=e(t);void 0!==r&&(t=r)}),o.done.forEach(function(e){return e(t)}),t}).catch(function(e){return s(c),t.error=e,o.fail.forEach(function(t){return t(e)}),Promise.reject(e)})};var d=function(t,e){this.config=t,e&&this.addHandler(e)};d.prototype.addHandler=function(t){this.handlers||(this.handlers=new Set),this.handlers.add(t)},d.prototype.removeHandler=function(t){this.handlers.delete(t)},d.prototype.exec=function(t,e){this.handlers&&this.handlers.forEach(function(r){return r(t,e)})};var l=function(t){var e=this;void 0===t&&(t=null),this.map={},t&&Object.keys(t).forEach(function(r){e.add(r,t[r])})};function y(t,r){return Array.isArray(t)?t.map(function(t){return r(t)}):e(t)?r(t):t}function v(t){return e(t)&&t.toJSON instanceof Function?t.toJSON():t}l.prototype.get=function(t){return this.map[t]},l.prototype.add=function(t,e,r){this.map[t]=new d(e,r)},l.prototype.remove=function(t){delete this.map[t]},l.prototype.addHandler=function(t,e){var r=this;return t.match(/\w+/g).forEach(function(t){var n=r.get(t);n&&n.addHandler(e)}),this},l.prototype.removeHandler=function(t,e){var r=this.get(t);r&&r.removeHandler(e)};var g=Object.freeze({process:y,toJSON:v,getUrls:function(t,e){var r=t.actions instanceof l,n=r?t.actions.map:t,o="";if(e){if(!r)throw new Error("Root path can only be queried on ApiGroup instances");o=t.http.axios.defaults.baseURL||""}return Object.keys(n).reduce(function(t,e){var i=n[e],u="string"==typeof i?i.replace(/^\w+\s+/,""):r?i.config.url:i.url;return t[e]=o+u,t},{})}});var b=Object.freeze({resource:function(t,e,r){return void 0===r&&(r=v),t.http.before.push(function(t){return y(t,function(t){return r(t)})}),t.http.after.push(function(t){return y(t.data,function(t){return new e(t)})}),this},remap:function(t,e){return t.http.before.push(function(t){return y(t,function(t){return i(t,e,!1)}),t}),t.http.after.push(function(t){return t.data=y(t.data,function(t){return i(t,e,!0)}),t}),this},data:function(t){return t.http.after.push(function(t){return t.data}),this}}),m=function(t){this.http=Object.freeze(new h(t)),this.error=null,this.loading=!1,Object.freeze(this.http)};m.prototype.use=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];var n=b[t];if(!n)throw new Error('No such plugin "'+t+'"');return n.apply(void 0,[this].concat(e)),this},m.prototype.request=function(t,e){return this.http.request(this,t,e)},m.prototype.get=function(t,e,r){return this.request(s({url:t,method:"get"},r),e)},m.prototype.post=function(t,e,r){return this.request(s({url:t,method:"post"},r),e)},m.prototype.done=function(t){return this.http.done.add(t),this},m.prototype.fail=function(t){return this.http.fail.add(t),this};var w=function(t){function r(r,n){var o=this;void 0===n&&(n=null),t.call(this,r),this.actions=Object.freeze(new l),e(n)&&Object.keys(n).forEach(function(t){o.add(t,n[t])})}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.add=function(t,e,r){var n=this;return e=c(e),this.actions.add(t,e,r),t in this||(this[t]=function(e,r){return n.call(t,e,r)}),this},r.prototype.call=function(t,e,r){var n=this.actions.get(t);if(!n)throw new Error('No such action "'+n+'"');return this.request(s(n.config,r),e).then(function(e){return n.handlers&&n.exec(e,t),Promise.resolve(e)})},r.prototype.when=function(t,e){return this.actions.addHandler(t,e),this},r}(m),j=function(t){function r(r,n){var o=this;if(t.call(this,r),"string"==typeof n){var i={read:"get",index:"get",create:"post",update:"patch",delete:"delete"};Object.keys(i).forEach(function(t){o.add(t,{method:i[t],url:n})})}else if(e(n)){var u={read:"get",index:"get",create:"post",update:"post",delete:"post"};Object.keys(n).map(function(t){var e=c(n[t],u[t]);o.add(t,e)})}}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.index=function(t){return this.call("index",t)},r.prototype.create=function(t){if(!e(t))throw new Error("Missing data parameter");return this.call("create",t)},r.prototype.read=function(t){if(void 0===t)throw new Error("Missing id parameter");return this.call("read",t)},r.prototype.update=function(t){if(!e(t))throw new Error("Missing data parameter");return this.call("update",t)},r.prototype.delete=function(t){if(void 0===t)throw new Error("Missing id parameter");return this.call("delete",t)},r}(w),O=function(t){function e(e,r,n,o){var i=this;if(void 0===o&&(o=!1),t.call(this,e,r),this.items=[],this.item=null,!this.actions.get("search")){var u=this.actions.get("index");this.add("search",u.config)}this.when("index search",function(t){i.items=t}).when("create read update delete",function(t){i.item=t}),o&&this.when("create update delete",function(t){return i.index()}),n&&this.use("resource",n),this.use("data")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.search=function(t){return this.call("search",t)},e}(j);t.default=m,t.ApiCore=m,t.ApiGroup=w,t.ApiEndpoint=j,t.ApiResource=O,t.plugins=b,t.helpers=g,t.utils=p,Object.defineProperty(t,"__esModule",{value:!0})});